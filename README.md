# Few-shot face translation
A GAN based approach for one model to swap them all.

The following figures illustrate our priliminary face-swapping results using <=5 photos of target face. Notice that almost all of the identities, except Stephen Curry, are not in our training data (which is a subset of [VGGFace2](http://www.robots.ox.ac.uk/~vgg/data/vgg_face2/)). All 281 results of these identities can be found [here](https://github.com/shaoanlu/fewshot-face-translation-GAN/tree/master/images/translation_results).

|   |[Andrej Karpathy](https://twitter.com/karpathy)|[Andrew Y. Ng](https://en.wikipedia.org/wiki/Andrew_Ng)|[Du Fu](https://en.wikipedia.org/wiki/Du_Fu)|[Elon Musk](https://en.wikipedia.org/wiki/Elon_Musk)|[Fei-Fei Li](https://en.wikipedia.org/wiki/Fei-Fei_Li)|[Geoffrey Hinton](https://en.wikipedia.org/wiki/Geoffrey_Hinton)|[Stephen Curry](https://en.wikipedia.org/wiki/Stephen_Curry)|[Yann Lecun](https://en.wikipedia.org/wiki/Yann_LeCun)|[Yoshua Benjio](https://en.wikipedia.org/wiki/Yoshua_Bengio)|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| **A.K.**|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrejKarpathy01_to_YoshuaBengio.png)|
| **A.Y.N**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_AndrejKarpathy.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/AndrewYNg01_to_YoshuaBengio.png)|
| **D.F.**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_AndrewYNg.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/DuFu01_to_YoshuaBengio.png)|
| **E.M.**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_DuFu.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/ElonMusk01_to_YoshuaBengio.png)|
| **F.F.L.**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_ElonMusk.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/FeiFei01_to_YoshuaBengio.png)|
| **G.H.**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_FeiFei.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/GeoffreyHinton01_to_YoshuaBengio.png)|
| **S.C.**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_GeoffreyHinton.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_YannLecun.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/StephenCurry01_to_YoshuaBengio.png)|
| **Y.L.**|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_StephenCurry.png)|N/A|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YannLecun01_to_YoshuaBengio.png)|
| **Y.B.**  |![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_AndrejKarpathy.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_AndrewYNg.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_DuFu.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_ElonMusk.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_FeiFei.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_GeoffreyHinton.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_StephenCurry.png)|![](https://github.com/shaoanlu/fewshot-face-translation-GAN/raw/master/images/translation_results/YoshuaBengio01_to_YannLecun.png)|N/A|
| |<img width=128/>|<img width=128/>|<img width=128/>|<img width=128/>|<img width=128/>|<img width=128/>|<img width=128/>|<img width=128/>|<img width=128/>|

#### I really like the Du Fu translation: such an interesting demostration how the GAN imagine the appearance of the prominent Chinese poet from just a painting.

However, our model has suboptimal performance in terms of translating to asian faces. This is possibly due to limited representability of the feature extractor.

## Architecture
![](https://github.com/shaoanlu/faceswap-GAN-swap-them-all/raw/master/images/few_shot_face_translation_gen.png)

![](https://github.com/shaoanlu/faceswap-GAN-swap-them-all/raw/master/images/few_shot_face_translation_dis.png)

The above image illustrates our generator, which is a encoder-decoder based network, at test phase. Our swap-them-all approach is basically a GAN conditioned on the latent embeddings extracted from a pre-trained face recognition model. [SPADE](https://arxiv.org/abs/1903.07291) and [AdaIN](https://arxiv.org/abs/1905.01723) modules are incorporated in order to inject semantic priors to the networks. During training phase, the input face A is heavily blurred and we train the model with resonctruction loss. Other objectives that aimed to improve translation performance while keeping semantic consistency, e.g., perceptual loss on rgb output and cosine similarity loss on laten embeddings, are also introduced.

### Things that didn't work

1. We tried to distort (spline warp, downsample) the input image as in [faceswap-GAN](https://github.com/shaoanlu/faceswap-GAN) instead of masking it. However, the model did not learn proper identity translation but output face that is similar to its input.

## References
1. [Semantic Image Synthesis with Spatially-Adaptive Normalization](https://arxiv.org/abs/1903.07291)
2. [Few-Shot Unsupervised Image-to-Image Translation](https://arxiv.org/abs/1905.01723)
3. [DEEP LEARNING FOR FASHION AND FORENSICS](https://drum.lib.umd.edu/handle/1903/21337)

